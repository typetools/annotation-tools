language: java

# For an unknown reason, this isn't getting executed and I need to put it in the
# jobs:include stages explicitly.
# script: ./.travis-build.sh

sudo: false

jobs:
  include:
    - stage: test
      jdk: oraclejdk8
      script: echo "annotation-tools travis-build.sh script starting" && ./.travis-build.sh
    - stage: trigger-downstream
      jdk: oraclejdk8
      script: |
        echo "TRAVIS_BRANCH=$TRAVIS_BRANCH TRAVIS_PULL_REQUEST=$TRAVIS_PULL_REQUEST"
        if [[ ($TRAVIS_BRANCH == master) &&
              ($TRAVIS_PULL_REQUEST == false) ]] ; then
          curl -LO https://raw.github.com/mernst/plume-lib/master/bin/trigger-travis.sh
          SLUGOWNER=${TRAVIS_REPO_SLUG%/*}
          sh trigger-travis.sh ${SLUGOWNER} checker-framework $TRAVIS_ACCESS_TOKEN
        fi

git:
  depth: 9
